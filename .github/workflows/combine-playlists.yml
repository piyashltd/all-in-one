name: Combine M3U Playlists

on:
  # 
  push:
    branches:
      - main  # 
    paths:
      # 
      - 'channels.m3u'
      - 'series.m3u'
      - 'movies.m3u'
      - 'islamic.m3u'
      - 'songs.m3u'
      # 

# **
permissions:
  contents: write 

jobs:
  build:
    runs-on: ubuntu-latest # 

    steps:
      # 
      - name: Checkout repository
        uses: actions/checkout@v4
        # 
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      # 
      - name: Combine M3U files
        run: |
          # index.m3u 
          echo '#EXTM3U x-tvg-url="YOUR_EPG_URL_HERE.xml"' > index.m3u
          
          # 
          grep -v "#EXTM3U" channels.m3u >> index.m3u
          grep -v "#EXTM3U" series.m3u >> index.m3u
          grep -v "#EXTM3U" movies.m3u >> index.m3u
          grep -v "#EXTM3U" islamic.m3u >> index.m3u
          grep -v "#EXTM3U" songs.m3u >> index.m3u
          
          # 
          
          echo "âœ… Playlists combined successfully."

      # 
      # 
      - name: Commit changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Auto-update index.m3u playlist"
          file_pattern: index.m3u # 
          commit_options: '--no-verify'
